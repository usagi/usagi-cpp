## main関数の戻り値とシェル上での利用

a.cxx

```C++
int main(){ return 123; }
```

このソースを`c++ a.cxx`などしてコンパイルすれば"a.out"実行可能ファイルが得られます。
環境によっては"a.exe"かもしれません。

これを実行`./a.out`すると、見た目には何も起こりませんが、
このプログラムはOSにエラーコードとして`123`を出力して終了しています。

`./a.out || echo "fail"`と実行してみましょう。
すると、"fail"と表示されるでしょう。

`./a.out || echo "fail($?)"`とすれば、
"123"と表示されるでしょう。

ちなみに、`||`はシェルで前のコマンドが失敗した場合に後ろのコマンドを実行する制御演算子、
`$?`変数は直前のコマンドのエラーコードが格納される特別なシェル変数です。

```C++
int main(){}
```

このソースではどうなるでしょう？
今度は`&&`を使ってみましょう。

`./a.out && echo success($?)`と実行すれば、
"success(0)"と表示されるでしょう。

`main`関数で`return`文を省略した場合は`return 0;`が
関数のスコープの終端にあるものとして扱われます。

C++の中の事だけではなく、こうしたOSを通したシェル上でのコマンドのやりとりにも
少し気を使っておくと、コマンドを組み合わせたスクリプトを作りたい時に役立ってくれるでしょう。

例えば、C++で作成された実行可能ファイルの実行が上手く行かなかった場合には
処理を中断するスクリプトは次のように書けます。

```bash
#!/bin/bash
./a.out || exit 1
```

但し、上手く実行できなかった際にはきちんと0以外のエラーコードを出力するように作ってあればです。