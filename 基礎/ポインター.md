# ポインター

「ポインター」とカタカナ言葉で覚えようとするとよくわからないかもしれませんが、
マウスのカーソルもポインターと呼びますし、
プレゼンテーションや講義の時に使う指示棒やレーザーのそれもポインターと呼びます。

CやC++でのポインターもこれらと同じ「指し示すもの」という意味です。

具体的には、計算機が認識する1次元に規則正しく並んで番地の振られたメモリー上の、
その番地、「メモリーアドレス」を「指し示すもの」が
CやC++で「ポインター」と呼ばれるものです。

計算機がソフトウェアを動かすにあたり、
CPUはメインメモリーにプログラムの実行バイナリーやデータ
実行中の変数やクラスなどのオブジェクトを読み書きします。

この時、ポインターの概念が無ければ、あるデータがどこにあるのかを
計算機は処理できません。

さて、うんちくはこのくらいにして、具体的にプログラムの実行中に、
オブジェクトが存在するメモリーアドレス、
つまりそのオブジェクトを指し示すポインターを取得して、
その値であるメモリー上の番地を確認してみましょう。

```C++
#include <iostream>
int main()
{
  int x = 123;
  std::cout << &x;
}
```

- http://melpon.org/wandbox/permlink/Y2XcyP7knHz399pG

このプログラムの実行結果は、

```bash
0x7fff20be27fc
```

などと表示されます。プログラムが実行されるたびに、計算機上で
プログラムのために確保されるメモリー領域は変わり、
`int x`のために確保されたメモリー領域の場所も変わります。
実行結果、表示されるアドレスが例と違っていても間違いではありません。

ここで`&x`の`&`はオブジェクトのアドレス、
つまりポインターを得る単項演算子です。

結果得られる値は今回の例では`0x7fff20be27fc`でしたが、
C++では通常あらゆる値には型情報があります。
`int x`は`int`型ですので、
このオブジェクト`x`から得たポインターは`int*`型、
「いんと・ぽいんたー・がた」です。

`int`型のオブジェクトを指し示すアドレス（N番地という数値）を表す型を
型名の後ろに`*`を付けて`int*`型と言います。

ちなみに、`int*`型のオブジェクトは「指し示すもの」ですから、
ポインターを取得した時とは逆にポインターから指し示す先のオブジェクを得る演算子もあります。

```C++
#include <iostream>
int main()
{
  int x = 123;
  int* p = &x;
  std::cout << p << ':' << *p << '\n';
  *p += 234;
  std::cout << p << ':' << *p << '\n';
}
```

この実行結果は、

```bash
0x7fff0735fbe4:123
0x7fff0735fbe4:357
```

の様になります。例によって`p`に格納されている`x`のアドレスは実行のたびに変わります。

`*p`の様に`*`単項演算子をポインターを格納するオブジェクト`p`に適用すると、
`p`の指し示す先のオブジェクト、つまりこの例では`x`として扱えます。

この`*`単項演算子を間接参照演算子と言い、
直接`x`ではなく、そのxが存在するメモリー上のアドレスを格納するオブジェクト`p`から
間接的にオブジェクトを参照するので間接参照と言います。